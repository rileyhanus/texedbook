\Preamble{xhtml,mathjax}

\Configure{tableofcontents*}{chapter,section,subsection,subsubsection,paragraph}   
\catcode`\:=11
\makeatletter
\ConfigureMark{paragraph}{\ifnum \c:secnumdepth>\c@secnumdepth\expandafter\:gobble
    \else
       \HCode{<span class="titlemark">}\@seccntformat{paragraph}%
       \HCode{</span>}\fi}
\Configure{paragraph}{}{}
  {\par\ShowPar\IgnoreIndent\HCode{<span
      class="paragraphHead"\a:LRdir>}\begingroup\bf\TitleMark}
  {\endgroup\HCode{</span>}\IgnorePar}
\Css{.paragraphToc{margin-left:8em;}}

\NewConfigure{tableofcontents*}[1]{%
   \def\:tempa{#1}\ifx\empty\:tempa
      \ifx \au:StartSec\:UnDef \else \gdef\:StartSec{\au:StartSec}\fi
   \else
      \edef\auto:toc{#1}%
         \ifx \au:StartSec\:UnDef
            \let\au:StartSec\:StartSec
            \def\:StartSec{\:tableofcontents
               \global\let\auto:toc\:UnDef \let\:StartSec\au:StartSec \:StartSec}%
            \pend:def\tableofcontents{\gdef\:StartSec{\au:StartSec}}%
   \fi  \fi
}
\makeatother
\catcode`\:=12

\ConfigureEnv{calchub}
{\ifvmode\IgnorePar\fi\EndP\HCode{<div class="calchub">}}
{\ifvmode\IgnorePar\fi\EndP\HCode{</div>}}
{} {}

\ConfigureEnv{youtube}
{\ifvmode\IgnorePar\fi\EndP\HCode{<div class="youtube">}}
{\ifvmode\IgnorePar\fi\EndP\HCode{</div>}}
{} {}

\ConfigureEnv{panopto}
{\ifvmode\IgnorePar\fi\EndP\HCode{<div class="panopto">}}
{\ifvmode\IgnorePar\fi\EndP\HCode{</div>}}
{} {}

\ConfigureEnv{trinket}
{\ifvmode\IgnorePar\fi\EndP\HCode{<div class="trinket">}}
{\ifvmode\IgnorePar\fi\EndP\HCode{</div>}}
{} {}

\renewcommand\mjref[1]{\NoFonts\HChar{92}eqref\{#1\}\EndNoFonts}

\begin{document}
\EndPreamble